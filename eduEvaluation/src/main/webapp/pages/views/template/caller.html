<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>静态表格</title>
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <link rel="stylesheet" href="../../layuiadmin/layui/css/layui.css" media="all">
  <link rel="stylesheet" href="../../layuiadmin/style/admin.css" media="all">
</head>
<body>

  
  <div class="layui-fluid">
    <div class="layui-row layui-col-space15">
      <div class="layui-col-md12">
        <div class="layui-card">
         
          <div class="layui-card-body">
            <table class="layui-table">
              <colgroup>
                <col width="150">
                <col width="150">
                <col width="200">
                <col>
             
                </colgroup>
                            <thead>
                              <tr>
                                <th>专业基本情况</th>
                                <th>支撑材料</th>
                                <th>操作</th>              
                              </tr> 
                            </thead>
                            <tbody>
                              <tr>
                                <td>专业任务书</td>
                                <td><div id="basic_form_num"></div></td>
                                <td><button id="basic_form_btn" type="button" class="layui-btn layui-btn-danger layuiadmin-btn-list layui-btn-xs"  style="font-size: 0;"><i class="layui-icon">&#xe642;</i></button></td>                  
                              </tr>
                              <tr>
                                <td>专业自评报告</td>
                                <td><div id="self_eval_num"></div></td>
                                <td><button class="layui-btn layui-btn-danger layui-btn-xs" id="self_eval_btn"><i class="layui-icon">&#xe642;</i></button><a href="javascript:;" style="left:-30px;position: relative;z-index:2;font-size: 0px;color: rgba(0,0,0,0);width:30px;height: 20px;display: inline-block;">支撑材料上传</a></td>              
                              </tr>   
                            </tbody>
                          </table>
                        </div>
                      </div>
                    </div>
                </div>

          </div>
        
 
 
<script src="../../layuiadmin/layui/layui.js"></script>
<script src="../util/Constants.js"></script>      
<script>  

var projectBase = Class.getURL();

layui.config({
    base: '../../layuiadmin/' //静态资源所在路径
  }).extend({
    index: 'lib/index' //主入口模块
  }).use(['index', 'form', 'admin'], function(){
    var $ = layui.$
    ,form = layui.form
	,admin = layui.admin;  
    
	var data = layui.data('collection');
	layui.data('collection',null);
	console.log("data:" + data['collection_major_id']);
	var data0;
	
      $.ajax({
		url: projectBase + '/collection/getBasicForm',
		dataType:'json',
		data: { 
			'collection_major_id':data['collection_major_id']
		},
		success:function(res){
			
			data0 = res.data;
			console.log(data0);
			console.log(data0[0].materials_num);
			$('#basic_form_num').html(data0[0].materials_num);
			$('#self_eval_num').html(data0[1].materials_num);
		},             
		 error:function(data){
									  
		  }     
	});  
	
	$('#basic_form_btn').on('click', function() {
		console.log("begin to do");
		layer.open({
			type: 2 //此处以iframe举例
				,
			title: '填报专业任务书',
			area: ['60%', '70%'],
			shade: 0,
			maxmin: true,
			btn: ['保存', '取消'],
			yes: function(index, layero) {
				//点击确认触发 iframe 内容中的按钮提交
				var submit = layero.find('iframe').contents().find("#material_form");
				console.log(submit);
				submit.click();
				
				var materials = layui.data('materials');
				console.log(materials);
				var data0 = [];
			},
			content: 'caller_edit.html',
			zIndex: layer.zIndex //重点1
				,
			success: function(layero, index) {
				var pf_id = layero.find('iframe').contents().find("#form_performance_id");
				$(pf_id).val(data0[0].performance_id);
				layer.setTop(layero); //重点2
			}
			});
	});
      

   });
   
 
</script>
</body>
</html>